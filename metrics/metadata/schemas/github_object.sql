CREATE EXTERNAL TABLE `github_object`(
  `body` struct<
    nc__links:struct<
      html:string,
      self:string>,
    active:boolean,
    allow_merge_commit:boolean,
    allow_rebase_merge:boolean,
    allow_squash_merge:boolean,
    archive_url:string,
    archived:boolean,
    assignees_url:string,
    avatar_url:string,
    billing_email:string,
    blobs_url:string,
    blog:string,
    branches_url:string,
    clone_url:string,
    collaborators:int,
    collaborators_url:string,
    comments_url:string,
    commit:struct<
      author:struct<
        avatar_url:string,
        events_url:string,
        followers_url:string,
        following_url:string,
        gists_url:string,
        gravatar_id:string,
        html_url:string,
        id:int,
        login:string,
        node_id:string,
        organizations_url:string,
        received_events_url:string,
        repos_url:string,
        site_admin:boolean,
        starred_url:string,
        subscriptions_url:string,
        type:string,
        url:string>,
      comments_url:string,
      commit:struct<
        author:struct<
          date:string,
          email:string,
          name:string>,
        comment_count:int,
        committer:struct<
          date:string,
          email:string,
          name:string>,
        message:string,
        tree:struct<
          sha:string,
          url:string>,
        url:string,
        verification:struct<
          payload:string,
          reason:string,
          signature:string,
          verified:boolean>>,
        committer:struct<
          avatar_url:string,
          events_url:string,
          followers_url:string,
          following_url:string,
          gists_url:string,
          gravatar_id:string,
          html_url:string,
          id:int,
          login:string,
          node_id:string,
          organizations_url:string,
          received_events_url:string,
          repos_url:string,
          site_admin:boolean,
          starred_url:string,
          subscriptions_url:string,
          type:string,
          url:string>,
        html_url:string,
        node_id:string,
        parents:array<
          struct<
            html_url:string,
            sha:string,
            url:string>>,
          sha:string,
          url:string>,
    commits_url:string,
    company:string,
    compare_url:string,
    config:struct<
      address:string,
      apiary_address:string,
      branch:string,
      branch_regexes:string,
      branches:string,
      central_repository:string,
      content_type:string,
      domain:string,
      insecure_ssl:string,
      integration_branch:string,
      jenkins_hook_url:string,
      long_url:string,
      message_without_join:string,
      mute_comments:string,
      mute_fork:string,
      mute_watch:string,
      mute_wiki:string,
      nick:string,
      nickserv_password:string,
      no_colors:string,
      notice:string,
      password:string,
      port:string,
      project_id:string,
      project_token:string,
      room:string,
      secret:string,
      send_from_author:string,
      server:string,
      server_url:string,
      ssl:string,
      subdomain:string,
      token:string,
      url:string,
      user:string,
      username:string>,
    contents_url:string,
    contributors_url:string,
    created_at:string,
    default_branch:string,
    default_repository_permission:string,
    deployments_url:string,
    description:string,
    disk_usage:int,
    documentation_url:string,
    downloads_url:string,
    email:string,
    enabled:boolean,
    enforce_admins:struct<
      enabled:boolean,
      url:string>,
    events:array<
      string>,
    events_url:string,
    followers:int,
    nc_following:int,
    fork:boolean,
    forks:int,
    forks_count:int,
    forks_url:string,
    full_name:string,
    git_commits_url:string,
    git_refs_url:string,
    git_tags_url:string,
    git_url:string,
    has_downloads:boolean,
    has_issues:boolean,
    has_organization_projects:boolean,
    has_pages:boolean,
    has_projects:boolean,
    has_repository_projects:boolean,
    has_wiki:boolean,
    homepage:string,
    hooks_url:string,
    html_url:string,
    id:int,
    is_verified:boolean,
    issue_comment_url:string,
    issue_events_url:string,
    issues_url:string,
    keys_url:string,
    labels_url:string,
    language:string,
    languages_url:string,
    last_response:struct<
      code:int,
      message:string,
      status:string>,
    license:struct<
      key:string,
      name:string,
      node_id:string,
      spdx_id:string,
      url:string>,
    location:string,
    login:string,
    members_can_create_repositories:boolean,
    members_url:string,
    merges_url:string,
    message:string,
    milestones_url:string,
    mirror_url:string,
    name:string,
    network_count:int,
    node_id:string,
    notifications_url:string,
    open_issues:int,
    open_issues_count:int,
    organization:struct<
      avatar_url:string,
      events_url:string,
      followers_url:string,
      following_url:string,
      gists_url:string,
      gravatar_id:string,
      html_url:string,
      id:int,
      login:string,
      node_id:string,
      organizations_url:string,
      received_events_url:string,
      repos_url:string,
      site_admin:boolean,
      starred_url:string,
      subscriptions_url:string,
      type:string,
      url:string>,
    owned_private_repos:int,
    owner:struct<
      avatar_url:string,
      events_url:string,
      followers_url:string,
      following_url:string,
      gists_url:string,
      gravatar_id:string,
      html_url:string,
      id:int,
      login:string,
      node_id:string,
      organizations_url:string,
      received_events_url:string,
      repos_url:string,
      site_admin:boolean,
      starred_url:string,
      subscriptions_url:string,
      type:string,
      url:string>,
    parent:struct<
      archive_url:string,
      archived:boolean,
      assignees_url:string,
      blobs_url:string,
      branches_url:string,
      clone_url:string,
      collaborators_url:string,
      comments_url:string,
      commits_url:string,
      compare_url:string,
      contents_url:string,
      contributors_url:string,
      created_at:string,
      default_branch:string,
      deployments_url:string,
      description:string,
      downloads_url:string,
      events_url:string,
      fork:boolean,
      forks:int,
      forks_count:int,
      forks_url:string,
      full_name:string,
      git_commits_url:string,
      git_refs_url:string,
      git_tags_url:string,
      git_url:string,
      has_downloads:boolean,
      has_issues:boolean,
      has_pages:boolean,
      has_projects:boolean,
      has_wiki:boolean,
      homepage:string,
      hooks_url:string,
      html_url:string,
      id:int,
      issue_comment_url:string,
      issue_events_url:string,
      issues_url:string,
      keys_url:string,
      labels_url:string,
      language:string,
      languages_url:string,
      license:struct<
        key:string,
        name:string,
        node_id:string,
        spdx_id:string,
        url:string>,
      merges_url:string,
      milestones_url:string,
      mirror_url:string,
      name:string,
      node_id:string,
      notifications_url:string,
      open_issues:int,
      open_issues_count:int,
      owner:struct<
        avatar_url:string,
        events_url:string,
        followers_url:string,
        following_url:string,
        gists_url:string,
        gravatar_id:string,
        html_url:string,
        id:int,
        login:string,
        node_id:string,
        organizations_url:string,
        received_events_url:string,
        repos_url:string,
        site_admin:boolean,
        starred_url:string,
        subscriptions_url:string,
        type:string,
        url:string>,
      private:boolean,
      pulls_url:string,
      pushed_at:string,
      releases_url:string,
      size:int,
      ssh_url:string,
      stargazers_count:int,
      stargazers_url:string,
      statuses_url:string,
      subscribers_url:string,
      subscription_url:string,
      svn_url:string,
      tags_url:string,
      teams_url:string,
      trees_url:string,
      updated_at:string,
      url:string,
      watchers:int,
      watchers_count:int>,
    permissions:struct<
      admin:boolean,
      pull:boolean,
      push:boolean>,
    ping_url:string,
    plan:struct<
      filled_seats:int,
      name:string,
      private_repos:int,
      seats:int,
      space:int>,
    private:boolean,
    private_gists:int,
    protected:boolean,
    protection:struct<
      enabled:boolean,
      required_status_checks:struct<
        contexts:array<
          string>,
        enforcement_level:string>>,
    protection_url:string,
    public_gists:int,
    public_members_url:string,
    public_repos:int,
    pulls_url:string,
    pushed_at:string,
    releases_url:string,
    repos_url:string,
    required_pull_request_reviews:struct<
      dismiss_stale_reviews:boolean,
      dismissal_restrictions:struct<
        teams:array<
          struct<
            description:string,
            id:int,
            members_url:string,
            name:string,
            node_id:string,
            permission:string,
            privacy:string,
            repositories_url:string,
            slug:string,
            url:string>>,
          teams_url:string,
          url:string,
          users:array<
            string>,
          users_url:string>,
        require_code_owner_reviews:boolean,
        url:string>,
    required_status_checks:struct<
      contexts:array<
        string>,
      contexts_url:string,
      strict:boolean,
      url:string>,
    restrictions:struct<
      teams:array<
        struct<
          description:string,
          id:int,
          members_url:string,
          name:string,
          node_id:string,
          permission:string,
          privacy:string,
          repositories_url:string,
          slug:string,
          url:string>>,
        teams_url:string,
        url:string,
        users:array<
          struct<
            avatar_url:string,
            events_url:string,
            followers_url:string,
            following_url:string,
            gists_url:string,
            gravatar_id:string,
            html_url:string,
            id:int,
            login:string,
            node_id:string,
            organizations_url:string,
            received_events_url:string,
            repos_url:string,
            site_admin:boolean,
            starred_url:string,
            subscriptions_url:string,
            type:string,
            url:string>>,
          users_url:string>,
    size:int,
    source:struct<
      archive_url:string,
      archived:boolean,
      assignees_url:string,
      blobs_url:string,
      branches_url:string,
      clone_url:string,
      collaborators_url:string,
      comments_url:string,
      commits_url:string,
      compare_url:string,
      contents_url:string,
      contributors_url:string,
      created_at:string,
      default_branch:string,
      deployments_url:string,
      description:string,
      downloads_url:string,
      events_url:string,
      fork:boolean,
      forks:int,
      forks_count:int,
      forks_url:string,
      full_name:string,
      git_commits_url:string,
      git_refs_url:string,
      git_tags_url:string,
      git_url:string,
      has_downloads:boolean,
      has_issues:boolean,
      has_pages:boolean,
      has_projects:boolean,
      has_wiki:boolean,
      homepage:string,
      hooks_url:string,
      html_url:string,
      id:int,
      issue_comment_url:string,
      issue_events_url:string,
      issues_url:string,
      keys_url:string,
      labels_url:string,
      language:string,
      languages_url:string,
      license:struct<
        key:string,
        name:string,
        node_id:string,
        spdx_id:string,
        url:string>,
      merges_url:string,
      milestones_url:string,
      mirror_url:string,
      name:string,
      node_id:string,
      notifications_url:string,
      open_issues:int,
      open_issues_count:int,
      owner:struct<
        avatar_url:string,
        events_url:string,
        followers_url:string,
        following_url:string,
        gists_url:string,
        gravatar_id:string,
        html_url:string,
        id:int,
        login:string,
        node_id:string,
        organizations_url:string,
        received_events_url:string,
        repos_url:string,
        site_admin:boolean,
        starred_url:string,
        subscriptions_url:string,
        type:string,
        url:string>,
      private:boolean,
      pulls_url:string,
      pushed_at:string,
      releases_url:string,
      size:int,
      ssh_url:string,
      stargazers_count:int,
      stargazers_url:string,
      statuses_url:string,
      subscribers_url:string,
      subscription_url:string,
      svn_url:string,
      tags_url:string,
      teams_url:string,
      trees_url:string,
      updated_at:string,
      url:string,
      watchers:int,
      watchers_count:int>,
    ssh_url:string,
    stargazers_count:int,
    stargazers_url:string,
    statuses_url:string,
    subscribers_count:int,
    subscribers_url:string,
    subscription_url:string,
    svn_url:string,
    tags_url:string,
    teams_url:string,
    test_url:string,
    total_private_repos:int,
    trees_url:string,
    two_factor_requirement_enabled:boolean,
    type:string,
    updated_at:string,
    url:string,
    watchers:int,
    watchers_count:int> COMMENT 'from deserializer',
  `date` string COMMENT 'from deserializer',
  `rc` int COMMENT 'from deserializer',
  `url` string COMMENT 'from deserializer',
  `when` struct<
    etag:string,
    last_modified:string> COMMENT 'from deserializer')
ROW FORMAT SERDE 
  'org.apache.hive.hcatalog.data.JsonSerDe' 
WITH SERDEPROPERTIES ( 
  'ignore.malformed.json'='true',
  'mapping.NC__links'='_links',
  'mapping.NC_following'='following',
  'mapping.last_modified'='last-modified') 
STORED AS INPUTFORMAT 
  'org.apache.hadoop.mapred.TextInputFormat' 
OUTPUTFORMAT 
  'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
LOCATION
  's3://foxsec-metrics/github/object_json'

